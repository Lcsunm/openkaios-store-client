let article_array,dataSet,page=0,pos_focus=0,tabindex_i=-0,window_status="article-list",panels=["All"],current_panel=0,server_list=["https://banana-hackers.gitlab.io/store-db/data.json"," https://farooqkz.github.io/data.json"];$(document).ready(function(){function a(e){let i=new XMLHttpRequest;i.open("GET",e),i.timeout=4e3,i.responseType="json",i.send(),i.ontimeout=function(t){toaster("timeout please wait I try another source"),a(server_list[1])},i.onload=function(){200!=i.status&&toaster(`Error ${i.status}: ${i.statusText}`),403==i.status&&(toaster("database not found try another"),a(server_list[1])),200==i.status&&(dataSet=i.response,t(),s(),$("div#message-box").css("display","none"))},i.onprogress=function(a){a.lengthComputable},i.onerror=function(){toaster("Request failed, please try later.")}}function t(){dataSet.apps.forEach(function(a,t){let s=dataSet.apps[t],e=s.name,i=s.description,n=s.download.url,o=s.git_repo,r=s.meta.categories,c=r.toString().replace(","," "),l=s.author.toString(),p=s.icon,d=s.license,u=s.type;-1===f.indexOf(l)&&f.push(s.author);let v="<div class='meta-data'><div><span>Author </span>"+l+"</div><div><span>License </span>"+d+"</div><div><span>Type </span>"+u+"</div></div>",_="data-download ='"+n+"' data-url ='"+o+"'",b=$("<article class= 'All "+c+"' "+_+"><div class='icon'><img src='"+p+"'></div><div class='channel'>"+c+"</div><h1>"+e+"</h1><div class='summary'>"+i+"</div>"+v+"</article>");$("div#app-panels").append(b)}),e();let a=moment(dataSet.generated_at).format("DD.MM.YYYY, HH:mm"),t="<h1>Contributors</h1>"+f.toString()+"<div class='footer'> Last update: "+a+"</div>",s=$("<article class='About'>"+t+"</article>");$("div#app-panels").append(s)}function s(){$.each(dataSet.categories,function(a,t){panels.push(a)}),panels.push("About"),$("div#navigation").append("<div>"+panels[0]+"</div>")}function e(){$("div#app-panels article").removeAttr("tabindex"),$("div#app-panels article").filter(":visible").each(function(a){$(this).prop("tabindex",a)}),article_array=$("div#app-panels article").filter(":visible"),i(),$("body").find("article[tabindex = 0]").focus()}function i(){let a=$("div#app-panels");a.find("article tabindex").sort(function(a,t){return t-a}).appendTo(a)}function n(a){$("article").css("display","none"),$("article."+a).css("display","block"),$("div#app-panels article").find([tabindex="0"]).focus()}function o(a){"left"==a&&current_panel>0&&(current_panel--,$("div#navigation div").text(panels[current_panel]),n(panels[current_panel]),e(),pos_focus=0),"right"==a&&current_panel<panels.length-1&&(current_panel++,$("div#navigation div").text(panels[current_panel]),n(panels[current_panel]),e(),pos_focus=0)}function r(a){if("article-list"==window_status){$(":focus")[0];if("+1"==a&&pos_focus<article_array.length-1&&(pos_focus++,pos_focus<=article_array.length)){let a=$(":focus")[0].offsetTop+20;window.scrollTo({top:a,left:100,behavior:"smooth"});let t=article_array[pos_focus];t.focus()}if("-1"==a&&pos_focus>0&&(pos_focus--,pos_focus>=0)){let a=article_array[pos_focus];a.focus();let t=$(":focus")[0].offsetTop;window.scrollTo({top:t+20,behavior:"smooth"})}}}function c(){let a=$(":focus");$("article").css("display","none"),$("div#navigation").css("display","none"),$("div#app-panels").css("margin","0 0 0 0"),a.css("display","block"),$("div.summary").css("display","block"),$("div.meta-data").css("display","block"),$("div.icon").css("display","block"),$("div.channel").css("display","none"),$("div#button-bar").css("display","block"),window_status="single-article"}function l(){navigator.spatialNavigationEnabled=!1,$("div#app-panels").css("margin","30px 0 0 0"),n(panels[current_panel]);$(":focus");$("div#navigation").css("display","block"),$("div#app-panels").css("display","block"),$("div.summary").css("display","none"),$("div.meta-data").css("display","none"),$("div.channel").css("display","block"),$("div.icon").css("display","none");let a=article_array[pos_focus];a.focus(),$("div#button-bar").css("display","none"),window.scrollTo(0,$(a).offset().top),$("div#source-page").css("display","none"),$("div#source-page iframe").attr("src",""),window_status="article-list"}function p(){let a=article_array[pos_focus],t=$(a).data("download");window.location.assign(t),notify("Message","App downloaded",!1,!0)}function d(){let a=article_array[pos_focus],t=$(a).data("url");window.open(t,"_self "),$("div#button-bar").css("display","none"),window_status="source-page",navigator.spatialNavigationEnabled=!0}function u(a){switch(a.key){case"Enter":c();break;case"ArrowDown":r("+1");break;case"ArrowUp":r("-1");break;case"ArrowLeft":o("left");break;case"ArrowRight":o("right");break;case"SoftLeft":case"1":"single-article"==window_status&&d();break;case"SoftRight":"single-article"==window_status&&p();break;case"Backspace":if(a.preventDefault(),"single-article"==window_status||"source-page"==window_status)return void l();"article-list"==window_status&&window.close()}}check_iconnection(),a(server_list[0]);let f=[];document.addEventListener("keydown",u)});