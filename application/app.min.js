let article_array,dataSet,page=0,pos_focus=0,tabindex_i=-0,window_status="article-list",panels=["All"],current_panel=0,server_list=["https://banana-hackers.gitlab.io/store-db/data.json"," https://farooqkz.github.io/data.json"];$(document).ready(function(){function t(a){let e=new XMLHttpRequest;e.open("GET",a),e.timeout=4e3,e.responseType="json",e.send(),e.ontimeout=function(s){toaster("timeout please wait I try another source"),t(server_list[1])},e.onload=function(){200!=e.status&&toaster(`Error ${e.status}: ${e.statusText}`),403==e.status&&(toaster("database not found try another"),t(server_list[1])),200==e.status&&(dataSet=e.response,s(),i(),setTimeout(function(){},1e4),$("div#message-box").css("animation-play-state","running"),$("div#message-box img.icon-2").css("animation-play-state","running"),$("div#message-box img.icon-1").css("animation-play-state","running"),$("div#message-box div").css("display","none"))},e.onprogress=function(t){t.lengthComputable},e.onerror=function(){toaster("Request failed, please try later.")}}function s(){$.when(dataSet.apps.forEach(function(t,s){let i=dataSet.apps[s],a=i.name,e=i.description,n=i.download.url,o=i.git_repo,c=i.donation,d=i.has_ads,l=i.has_tracking,r=i.meta.categories,p=i.meta.categories,u=r.toString().replace(","," "),v=p.toString().replace(","," "),b=i.author.toString(),h=i.icon,g=i.license,w=i.type,y="",m="",_="none",k="none",x="none",T="elem-"+s;-1===f.indexOf(b)&&f.push(b),i.screenshots&&(y=i.screenshots.toString(),y=y.split(","),y.forEach(function(t,s){m+="<li><img src="+y[s]+"></li>"})),$("div#options").append("<div id='"+T+"'></div>"),o&&$("div#options div#"+T).append("<div tabindex='0' data-url='"+o+"'>source code of the app</div>"),c&&(_="yes",$("div#options div#"+T).append("<div tabindex='1' data-url='"+c+"'>make a donation</div>")),l&&(x="yes"),d&&(_="yes");let A="<div class='meta-data'><div><span>Author </span>"+b+"</div><div><span>License </span>"+g+"</div><div><span>Type </span>"+w+"</div><div><span>Donation </span>"+_+"</div><div><span>Tracking </span>"+x+"</div><div><span>Ads </span>"+k+"</div></div>",S="data-download ='"+n+"' data-url ='"+o+"'  data-tags ='"+v+"'",E="<article id= '"+T+"' class= 'All "+u+" ' "+S+"><div class='icon'><img src='"+h+"'></div><div class='channel'>"+u+"</div><h1>"+a+"</h1><div class='summary'>"+e+"</div>"+A+"<div class='images'></div><ul class='images'>"+m+"</article>";$("div#app-panels").append(E)})).then(function(){a();let t=moment(dataSet.generated_at).format("DD.MM.YYYY, HH:mm"),s="<div>An alternative app store by free developers for free devices.The database of apps is hosted https://banana-hackers.gitlab.io/store-db , further can be added by a pull request.</div><div id='contributors'><h1>Contributors</h1>"+f.toString()+"</div><div><h1>Respect</h1><div>Respect the licenses of the apps, it would be nice if you use app more often to support the developer with a donation.<br>Thanks!</div><div class='footer'> Last update: "+t+"</div>",i=$("<article class='About'>"+s+"</article>");$("div#app-panels").append(i),getData(),$("article#search input").focus()})}function i(){$.each(dataSet.categories,function(t,s){panels.push(t)}),panels.push("About"),$("div#navigation").append("<div>"+panels[0]+"</div>")}function a(){$("div#app-panels article").removeAttr("tabindex"),$("div#app-panels article").filter(":visible").each(function(t){$(this).prop("tabindex",t)}),article_array=$("div#app-panels article").filter(":visible"),e(),$("body").find("article[tabindex = 0]").focus()}function e(){let t=$("div#app-panels");t.find("article tabindex").sort(function(t,s){return s-t}).appendTo(t)}function n(t){$("article").css("display","none"),$("article."+t).css("display","block"),$("div#app-panels article").find([tabindex="0"]).focus()}function o(t){"left"==t&&current_panel--,"right"==t&&current_panel++,current_panel%=panels.length,current_panel<0&&(current_panel+=panels.length),$("div#navigation div").text(panels[current_panel]),n(panels[current_panel]),a(),pos_focus=0,0==current_panel&&($("input").val(""),$("input").focus())}function c(t){let s=$(":focus").attr("tabindex"),i=$(":focus").parent().children(":visible"),a=$(":focus").parent().children(":visible").length;if($("input").is(":focus")&&$("article#search").next().focus(),"+1"==t&&s<a-1){s++,i[s].focus();let t=$(":focus")[0].offsetTop;window.scrollTo({top:t-35,behavior:"smooth"}),$("article#search").is(":focus")&&$("input").focus()}if("-1"==t&&s>0){s--,i[s].focus();let t=$(":focus")[0].offsetTop;window.scrollTo({top:t-35,behavior:"smooth"}),$("article#search").is(":focus")&&$("input").focus()}}function d(){let t=$(":focus"),s=t.attr("class"),i=$(":focus").parent().attr("id");if("search"==i)return!1;"About"==s&&"search"==i||($("article").css("display","none"),$("div#navigation").css("display","none"),$("div#app div#app-panels").css("margin","5px 0 0 0"),$("div#app div#app-panels").css("max-height","100%"),$("div#app div#app-panels").css("overflow-y","scroll"),t.css("display","block"),$("div.summary").css("display","block"),$("div.meta-data").css("display","block"),$("div.icon").css("display","block"),$("div.channel").css("display","none"),$("ul.images").css("display","block"),$("div#button-bar").css("display","block"),$("div#button-bar div#button-left").css("color","white"),$("div#button-bar div#button-center").css("color","black"),$("div#button-bar div#button-right").css("color","white"),window_status="single-article")}function l(){navigator.spatialNavigationEnabled=!1,n(panels[current_panel]),$("div#app div#app-panels").css("margin","32px 0 0 0"),$("div#app div#app-panels").css("max-height","73%"),$("div#options").css("display","none");$(":focus");$("div#navigation").css("display","block"),$("div#app-panels").css("display","block"),$("div.summary").css("display","none"),$("div.meta-data").css("display","none"),$("div.channel").css("display","block"),$("ul.images").css("display","none"),$("div.icon").css("display","none");let t=article_array[pos_focus];t.focus(),$("div#button-bar").css("display","block"),$("div#button-bar div#button-left").css("color","black"),$("div#button-bar div#button-center").css("color","white"),$("div#button-bar div#button-right").css("color","black"),window.scrollTo(0,$(t).offset().top),window_status="article-list"}function r(){let t="",s=$(":focus");t=$(s).data("download"),window.location.assign(t)}function p(){let t=$(":focus"),s=$(t).data("url");window.open(s,"_self ")}function u(){let t=$(":focus"),s=t.attr("id");$("div#options div").css("display","none"),$("div#options").css("display","block"),$("div#options div#"+s).css("display","block"),$("div#options div#"+s+" div").css("display","block"),$("div#button-bar div#button-left").css("color","black"),$("div#button-bar div#button-center").css("color","white"),$("div#button-bar div#button-right").css("color","black"),$("div#options div#"+s+" div:first").focus(),window_status="options"}function v(t){switch(t.key){case"Enter":"article-list"==window_status&&d(),"options"==window_status&&p();break;case"ArrowDown":c("+1");break;case"ArrowUp":c("-1");break;case"ArrowLeft":"article-list"==window_status&&o("left");break;case"ArrowRight":"article-list"==window_status&&o("right");break;case"SoftLeft":"single-article"==window_status&&u();break;case"SoftRight":"single-article"==window_status&&r();break;case"Backspace":if(t.preventDefault(),"single-article"==window_status||"options"==window_status)return void l();"article-list"!=window_status||$("input").is(":focus")||window.close()}}check_iconnection(),t(server_list[0]);let f=["40min"];document.addEventListener("keydown",v)});