let article_array,dataSet,page=0,pos_focus=0,tabindex_i=-0,window_status="article-list",panels=["All"],current_panel=0,server_list=["https://banana-hackers.gitlab.io/store-db/data.json"," https://farooqkz.github.io/data.json"];$(document).ready(function(){function t(s){let i=new XMLHttpRequest;i.open("GET",s),i.timeout=4e3,i.responseType="json",i.send(),i.ontimeout=function(a){toaster("timeout please wait I try another source"),t(server_list[1])},i.onload=function(){200!=i.status&&toaster(`Error ${i.status}: ${i.statusText}`),403==i.status&&(toaster("database not found try another"),t(server_list[1])),200==i.status&&(dataSet=i.response,a(),e(),$("div#message-box").css("display","none"))},i.onprogress=function(t){t.lengthComputable},i.onerror=function(){toaster("Request failed, please try later.")}}function a(){dataSet.apps.forEach(function(t,a){let e=dataSet.apps[a],s=e.name,i=e.description,o=e.download.url,n=e.git_repo,r=e.meta.categories,c=r.toString().replace(","," "),l=e.author.toString(),d=e.icon,p=e.license,u=e.type;-1===f.indexOf(l)&&f.push(l);let v="<div class='meta-data'><div><span>Author </span>"+l+"</div><div><span>License </span>"+p+"</div><div><span>Type </span>"+u+"</div></div>",b="data-download ='"+o+"' data-url ='"+n+"'",_=$("<article class= 'All "+c+"' "+b+"><div class='icon'><img src='"+d+"'></div><div class='channel'>"+c+"</div><h1>"+s+"</h1><div class='summary'>"+i+"</div>"+v+"</article>");$("div#app-panels").append(_)}),s();let t=moment(dataSet.generated_at).format("DD.MM.YYYY, HH:mm"),a="<div>An alternative app store by free developers for free devices.The database of apps is hosted https://banana-hackers.gitlab.io/store-db , further can be added by a pull request.</div><div id='contributors'><h1>Contributors</h1>"+f.toString()+"</div><div class='footer'> Last update: "+t+"</div>",e=$("<article class='About'>"+a+"</article>");$("div#app-panels").append(e)}function e(){$.each(dataSet.categories,function(t,a){panels.push(t)}),panels.push("About"),$("div#navigation").append("<div>"+panels[0]+"</div>")}function s(){$("div#app-panels article").removeAttr("tabindex"),$("div#app-panels article").filter(":visible").each(function(t){$(this).prop("tabindex",t)}),article_array=$("div#app-panels article").filter(":visible"),i(),$("body").find("article[tabindex = 0]").focus()}function i(){let t=$("div#app-panels");t.find("article tabindex").sort(function(t,a){return a-t}).appendTo(t)}function o(t){$("article").css("display","none"),$("article."+t).css("display","block"),$("div#app-panels article").find([tabindex="0"]).focus()}function n(t){"left"==t&&current_panel--,"right"==t&&current_panel++,current_panel%=panels.length,current_panel<0&&(current_panel+=panels.length),$("div#navigation div").text(panels[current_panel]),o(panels[current_panel]),s(),pos_focus=0}function r(t){if("article-list"==window_status){$(":focus")[0];if("+1"==t&&pos_focus<article_array.length-1&&(pos_focus++,pos_focus<=article_array.length)){let t=$(":focus")[0].offsetTop+20;window.scrollTo({top:t,left:100,behavior:"smooth"});let a=article_array[pos_focus];a.focus()}if("-1"==t&&pos_focus>0&&(pos_focus--,pos_focus>=0)){let t=article_array[pos_focus];t.focus();let a=$(":focus")[0].offsetTop;window.scrollTo({top:a+20,behavior:"smooth"})}}}function c(){let t=$(":focus");$("article").css("display","none"),$("div#navigation").css("display","none"),$("div#app div#app-panels").css("margin","5px 0 0 0"),t.css("display","block"),$("div.summary").css("display","block"),$("div.meta-data").css("display","block"),$("div.icon").css("display","block"),$("div.channel").css("display","none"),$("div#button-bar").css("display","block"),$("div#button-bar div#button-left").css("color","white"),$("div#button-bar div#button-center").css("color","black"),$("div#button-bar div#button-right").css("color","white"),window_status="single-article"}function l(){navigator.spatialNavigationEnabled=!1,o(panels[current_panel]),$("div#app div#app-panels").css("margin","32px 0 0 0");$(":focus");$("div#navigation").css("display","block"),$("div#app-panels").css("display","block"),$("div.summary").css("display","none"),$("div.meta-data").css("display","none"),$("div.channel").css("display","block"),$("div.icon").css("display","none");let t=article_array[pos_focus];t.focus(),$("div#button-bar").css("display","block"),$("div#button-bar div#button-left").css("color","black"),$("div#button-bar div#button-center").css("color","white"),$("div#button-bar div#button-right").css("color","black"),window.scrollTo(0,$(t).offset().top),window_status="article-list"}function d(){let t=article_array[pos_focus],a=$(t).data("download");window.location.assign(a)}function p(){let t=article_array[pos_focus],a=$(t).data("url");window.open(a,"_self ")}function u(t){switch(t.key){case"Enter":c();break;case"ArrowDown":r("+1");break;case"ArrowUp":r("-1");break;case"ArrowLeft":"article-list"==window_status&&n("left");break;case"ArrowRight":"article-list"==window_status&&n("right");break;case"SoftLeft":case"1":"single-article"==window_status&&p();break;case"SoftRight":"single-article"==window_status&&d();break;case"Backspace":if(t.preventDefault(),"single-article"==window_status||"source-page"==window_status)return void l();"article-list"==window_status&&window.close()}}check_iconnection(),t(server_list[0]);let f=["40min"];document.addEventListener("keydown",u)});