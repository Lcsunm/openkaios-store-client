let article_array,dataSet,i=-1,debug="false",page=0,pos_focus=0,tabindex_i=-0,window_status="article-list";$(document).ready(function(){function s(){let s=new XMLHttpRequest;s.open("GET","https://banana-hackers.gitlab.io/store-db/data.json"),s.responseType="json",s.send(),s.onload=function(){200!=s.status?toaster(`Error ${s.status}: ${s.statusText}`):(dataSet=s.response,a(),$("div#message-box").css("display","none"))},s.onprogress=function(s){s.lengthComputable},s.onerror=function(){toaster("Request failed, please try later.")}}function a(){dataSet.apps.forEach(function(s,a){let t=dataSet.apps[a],e=t.name,o=t.description,i=t.download.url,n=t.git_repo,c=t.meta.categories,l=t.author,r=t.icon,d=t.license,u=t.type,p="<div class='meta-data'><div><span>License </span>"+l+"</div><div><span>Author </span>"+d+"</div><div><span>Type </span>"+u+"</div></div>",f="data-download ='"+i+"'data-url ='"+n+"'",w=$("<article "+f+"><div class='icon'><img src='"+r+"'></div><div class='channel'>"+c+"</div><h1>"+e+"</h1><div class='summary'>"+o+"</div>"+p+"</article>");$("div#news-feed-list").append(w)}),e()}function t(){$("div#news-feed-list article").each(function(s){$(this).prop("tabindex",s),$("div#news-feed-list article:first").focus()})}function e(){let s=$("div#news-feed-list");s.find("article").sort(function(s,a){return+a.dataset.order-+s.dataset.order}).appendTo(s),article_array=$("div#news-feed-list article"),t()}function o(s){if("article-list"==window_status){$(":focus")[0];if("+1"==s&&pos_focus<article_array.length-1&&(pos_focus++,pos_focus<=article_array.length)){let s=$(":focus")[0].offsetTop+20;window.scrollTo({top:s,left:100,behavior:"smooth"});let a=article_array[pos_focus];a.focus()}if("-1"==s&&pos_focus>0&&(pos_focus--,pos_focus>=0)){let s=article_array[pos_focus];s.focus();let a=$(":focus")[0].offsetTop;window.scrollTo({top:a+20,behavior:"smooth"})}}}function i(){let s=$(":focus");$("article").css("display","none"),s.css("display","block"),$("div.summary").css("display","block"),$("div.meta-data").css("display","block"),$("div.icon").css("display","block"),$("div.channel").css("display","none"),$("div#button-bar").css("display","block"),window_status="single-article"}function n(){$(":focus");$("article").css("display","block"),$("div.summary").css("display","none"),$("div.meta-data").css("display","none"),$("div.channel").css("display","block"),$("div.icon").css("display","none"),$("div#button-bar").css("display","none");let s=article_array[pos_focus];s.focus(),window.scrollTo(0,$(s).offset().top),$("div#source-page").css("display","none"),$("div#source-page iframe").attr("src",""),$("div#button-bar div#button-right").css("display","block"),window_status="article-list"}function c(){let s=article_array[pos_focus],a=$(s).data("download");window.location.assign(a)}function l(){let s=article_array[pos_focus],a=$(s).data("url");alert(a),window.location.assign(a)}function r(s){switch(s.key){case"Enter":i();break;case"ArrowDown":o("+1");break;case"ArrowUp":o("-1");break;case"SoftLeft":"single-article"==window_status&&l();break;case"SoftRight":c(),"single-article"==window_status&&c();break;case"Backspace":s.preventDefault(),"article-list"==window_status&&window.close(),n();break;case"2":auto_scroll(30,"on")}}check_iconnection(),s(),document.addEventListener("keydown",r)});