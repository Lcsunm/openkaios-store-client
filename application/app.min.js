let article_array,dataSet,i=-1,debug="false",page=0,pos_focus=0,tabindex_i=-0,window_status="article-list";$(document).ready(function(){function s(s){let t=new XMLHttpRequest;t.open("GET",s),t.responseType="json",t.send(),t.onload=function(){200!=t.status&&toaster(`Error ${t.status}: ${t.statusText}`),t.status,200==t.status&&(dataSet=t.response,a(),$("div#message-box").css("display","none"))},t.onprogress=function(s){s.lengthComputable},t.onerror=function(){toaster("Request failed, please try later.")}}function a(){dataSet.apps.forEach(function(s,a){let t=dataSet.apps[a],e=t.name,i=t.description,o=t.download.url,n=t.git_repo,c=t.meta.categories,d=t.author,l=t.icon,r=t.license,p=t.type,u="<div class='meta-data'><div><span>Author </span>"+d+"</div><div><span>License </span>"+r+"</div><div><span>Type </span>"+p+"</div></div>",f="data-download ='"+o+"'data-url ='"+n+"'",w=$("<article "+f+"><div class='icon'><img src='"+l+"'></div><div class='channel'>"+c+"</div><h1>"+e+"</h1><div class='summary'>"+i+"</div>"+u+"</article>");$("div#news-feed-list").append(w)}),e()}function t(){$("div#news-feed-list article").each(function(s){$(this).prop("tabindex",s),$("div#news-feed-list article:first").focus()})}function e(){let s=$("div#news-feed-list");s.find("article").sort(function(s,a){return+a.dataset.order-+s.dataset.order}).appendTo(s),article_array=$("div#news-feed-list article"),t()}function i(s){if("article-list"==window_status){$(":focus")[0];if("+1"==s&&pos_focus<article_array.length-1&&(pos_focus++,pos_focus<=article_array.length)){let s=$(":focus")[0].offsetTop+20;window.scrollTo({top:s,left:100,behavior:"smooth"});let a=article_array[pos_focus];a.focus()}if("-1"==s&&pos_focus>0&&(pos_focus--,pos_focus>=0)){let s=article_array[pos_focus];s.focus();let a=$(":focus")[0].offsetTop;window.scrollTo({top:a+20,behavior:"smooth"})}}}function o(){let s=$(":focus");$("article").css("display","none"),s.css("display","block"),$("div.summary").css("display","block"),$("div.meta-data").css("display","block"),$("div.icon").css("display","block"),$("div.channel").css("display","none"),$("div#button-bar").css("display","block"),window_status="single-article"}function n(){navigator.spatialNavigationEnabled=!1;$(":focus");$("div#news-feed-list").css("display","block"),$("article").css("display","block"),$("div.summary").css("display","none"),$("div.meta-data").css("display","none"),$("div.channel").css("display","block"),$("div.icon").css("display","none");let s=article_array[pos_focus];s.focus(),$("div#button-bar").css("display","none"),window.scrollTo(0,$(s).offset().top),$("div#source-page").css("display","none"),$("div#source-page iframe").attr("src",""),window_status="article-list"}function c(){let s=article_array[pos_focus],a=$(s).data("download");window.location.assign(a),notify("Message","App downloaded",!1)}function d(){let s=article_array[pos_focus],a=$(s).data("url");$("div#news-feed-list").css("display","none"),$("div#source-page").css("display","block"),$("div#source-page iframe").attr("src",a),$("div#button-bar").css("display","none"),window_status="source-page",navigator.spatialNavigationEnabled=!0}function l(s){switch(s.key){case"Enter":o();break;case"ArrowDown":i("+1");break;case"ArrowUp":i("-1");break;case"SoftLeft":"single-article"==window_status&&d();break;case"SoftRight":"single-article"==window_status&&c();break;case"Backspace":if(s.preventDefault(),"single-article"==window_status||"source-page"==window_status)return void n();"article-list"==window_status&&window.close()}}check_iconnection(),s("https://banana-hackers.gitlab.io/store-db/data.json"),document.addEventListener("keydown",l)});